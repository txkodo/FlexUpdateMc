# FlexUpdateMc

カスタム改変を保持しながらMinecraftワールドを異なるバージョン間で移行するためのRustベースのツールです。

## 概要

FlexUpdateMcは、サーバーバージョンを変更する際にMinecraftワールドを更新する柔軟なアプローチを提供します。単純にワールドデータを置き換えるのではなく、以下の3つのチャンクを比較することで、インテリジェントにチャンクを移行します：

- **旧編集済みチャンク**: あなたの改変が含まれた現在のワールド
- **旧プレーンチャンク**: 旧バージョンで生成されたバニラチャンク
- **新プレーンチャンク**: 新バージョンで生成されたバニラチャンク

これにより、カスタム改変を保持しながら、ワールドフォーマットと生成システムを新しいMinecraftバージョンに更新することができます。

## アーキテクチャ

プロジェクトは以下の主要コンポーネントで構成されています：

### コアモデル (`src/model.rs`)
- `McDimension`: Minecraftのディメンション（オーバーワールド、ネザー、エンド、カスタム）を表現
- `McChunkPos`: x、y座標とディメンションを持つチャンク位置
- `McChunk`: チャンクデータ構造
- `McVersion`: Minecraftバージョン情報

### サービス
- **FlexUpdater** (`src/service/flex_updater.rs`): 全体の更新プロセスを管理するメインオーケストレーター
- **ChunkMigrator** (`src/service/chunk_migrator.rs`): チャンク移行ロジックを実装するためのトレイト
- **ServerFactory** (`src/service/server_factory.rs`): 異なるシナリオ用のサーバーハンドラーを作成
- **ServerHandler** (`src/service/server_handler.rs`): チャンクの生成と操作を管理
- **WorldHandler** (`src/service/world_handler.rs`): ワールドファイル操作とディレクトリ構造を処理

### 移行プロセス

1. **サーバー作成**: 3つのサーバーインスタンスを作成：
   - 元のワールドデータを持つターゲットサーバー
   - リージョンデータなしの旧プレーンサーバー
   - リージョンデータなしの新プレーンサーバー

2. **チャンク処理**: 各チャンクに対して：
   - ターゲットサーバーで新バージョンフォーマットのチャンクを生成
   - 旧バージョンでチャンクを生成し、新フォーマットに更新
   - 新バージョンで新規チャンクを生成
   - 3つのバージョンを比較してチャンクを移行

3. **リージョン更新**: 全ディメンション（オーバーワールド、ネザー、エンド）のリージョンファイルを上書き

## プロジェクト構造

このプロジェクトはCargoワークスペースとして構成されています：

```
FlexUpdateMc/
├── Cargo.toml          # ワークスペース設定
├── bin/                # メインのFlexUpdateMcアプリケーション
│   ├── Cargo.toml
│   ├── src/
│   └── tests/
└── bot/                # Minecraftボット関連機能
    ├── Cargo.toml
    └── src/
```

## ビルド

```bash
# 全体をビルド
cargo build --release

# 特定のクレートをビルド
cargo build -p flex_updater_mc
cargo build -p bot
```

## 使用方法

このツールは現在開発中です。メインエントリーポイントは"Hello, world!"を出力するプレースホルダーです。

あなたのプロジェクトでこのライブラリを使用するには、以下のトレイトを実装してください：
- `ChunkMigrator`: 特定の移行ロジック用
- `ServerFactory`: サーバーインスタンス作成用
- `ServerHandler`: チャンク操作用

## プロジェクトステータス

これはMinecraftワールド移行のアーキテクチャを提供する基盤実装です。異なるMinecraftバージョンやサーバータイプ用の具体的な実装を追加する必要があります。

## 依存関係

現在はRust標準ライブラリの依存関係のみを使用しています。以下の機能には追加の依存関係が必要になる可能性があります：
- Minecraft NBTデータの解析
- リージョンファイル（.mca）の処理
- サーバー統合

## ライセンス

未指定 - 適切なライセンス情報を追加してください。